(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[479],{327:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var a=t(5155),r=t(2115),l=t(5205),c=t(8753),n=t(877),i=t(1607);function o(e){let{submissions:s}=e;if(0===s.length)return(0,a.jsx)("p",{className:"text-gray-500",children:"아직 학습 기록이 없습니다. 퀴즈를 풀고 오세요!"});let t=[...s].reverse(),r={labels:t.map((e,s)=>"".concat(s+1,"회차")),datasets:[{label:"점수 추이",data:t.map(e=>e.score),borderColor:"#78AAD4",backgroundColor:"rgba(120, 170, 212, 0.5)",fill:!0,tension:.1}]};return(0,a.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"최근 학습 점수 추이"}),(0,a.jsx)(n.N1,{options:{responsive:!0,scales:{y:{beginAtZero:!0,max:100}},plugins:{legend:{display:!1}}},data:r})]})}function d(e){let{submissions:s}=e,t=(0,r.useMemo)(()=>{if(!s||0===s.length)return[];let e={};s.forEach(s=>{s.isCorrect&&Array.isArray(s.isCorrect)&&s.isCorrect.forEach(t=>{let a=s.subChapter||"기타";e[a]||(e[a]={total:0,correct:0}),e[a].total++,t&&e[a].correct++})});let t=Object.entries(e).map(e=>{let[s,t]=e;return{chapterName:s,accuracy:t.total>0?Math.round(t.correct/t.total*100):0,totalQuestions:t.total,correctQuestions:t.correct}});return t.sort((e,s)=>e.accuracy-s.accuracy),t},[s]);return 0===t.length?(0,a.jsx)("div",{className:"text-center p-8 bg-white rounded-lg shadow-sm",children:(0,a.jsxs)("p",{className:"text-slate-500",children:["아직 학습 기록이 충분하지 않아요.",(0,a.jsx)("br",{}),"퀴즈를 풀고 나면 이곳에서 약점을 분석해 드릴게요!"]})}):(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>{var s;return(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("span",{className:"font-semibold text-slate-700 truncate pr-4",children:e.chapterName}),(0,a.jsxs)("span",{className:"text-sm font-bold text-slate-600",children:[e.accuracy,"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,a.jsx)("div",{className:"h-2.5 rounded-full transition-all duration-500 ".concat((s=e.accuracy)<50?"bg-red-400":s<80?"bg-yellow-400":"bg-green-400"),style:{width:"".concat(e.accuracy,"%")}})}),(0,a.jsxs)("p",{className:"text-xs text-right text-slate-500 mt-1",children:["(",e.totalQuestions,"문제 중 ",e.correctQuestions,"문제 정답)"]})]},e.chapterName)})})}i.t1.register(i.PP,i.kc,i.FN,i.No,i.hE,i.m_,i.s$);var u=t(9245),x=t(3125),m=t(5190),h=t(5465),b=t(9708);function p(){let{user:e}=(0,l.A)(),{submissions:s,loading:t}=(0,c.f)(),[n,i]=(0,r.useState)(null),[p,j]=(0,r.useState)(!0),[N,g]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!e)return void j(!1);let s=(0,b.H9)(h.db,"learningPlans",e.uid);(0,b.x7)(s).then(e=>{e.exists()?i(e.data()):i(null),j(!1)})},[e]);let f=async s=>{if(!e)return;let t=(0,b.H9)(h.db,"learningPlans",e.uid),a={...s,userId:e.uid,status:"active",updatedAt:(0,b.O5)()};n||(a.createdAt=(0,b.O5)()),await (0,b.BN)(t,a,{merge:!0}),i({...n,...a,updatedAt:new Date,createdAt:(null==n?void 0:n.createdAt)||new Date}),g(!1)};return t||p?(0,a.jsx)("div",{className:"text-center p-8",children:"데이터를 불러오는 중입니다..."}):e?(0,a.jsxs)("div",{className:"p-8 max-w-4xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"마이페이지"}),(0,a.jsxs)("section",{className:"mb-12",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold border-b pb-2 mb-4",children:"학습 계획"}),n?(0,a.jsx)(x.A,{plan:n,submissions:s,onEditClick:()=>g(!0),onStartRecommended:()=>{}}):(0,a.jsx)(m.A,{onSetupClick:()=>g(!0)})]}),(0,a.jsxs)("section",{className:"mb-12",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold border-b pb-2 mb-4",children:"학습 대시보드"}),(0,a.jsx)(o,{submissions:s})]}),(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold border-b pb-2 mb-4",children:"단원별 약점 분석"}),(0,a.jsx)(d,{submissions:s})]}),N&&(0,a.jsx)(u.A,{onClose:()=>g(!1),onSave:f,existingPlan:n})]}):(0,a.jsx)("div",{className:"text-center p-8",children:"로그인이 필요한 페이지입니다."})}},7274:(e,s,t)=>{Promise.resolve().then(t.bind(t,327))}},e=>{e.O(0,[135,965,647,463,865,603,814,441,255,358],()=>e(e.s=7274)),_N_E=e.O()}]);